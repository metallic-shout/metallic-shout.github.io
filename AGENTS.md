# AGENTS.md

## Purpose（目的）

このドキュメントは、本リポジトリにおいて  
**人間および AI エージェントがどのように振る舞うべきか**を定義するものです。

目的は以下です。

- 設計意図・判断基準の保持
- 制約を無視した変更の防止
- 意思決定を再現可能・レビュー可能な形で残すこと

本リポジトリでは、  
**汎用性や慣習よりも、明確さ・最小性・意図駆動の設計**を優先します。

---

## Tech Stack（利用技術）

- Framework: Nuxt 4
- Language: TypeScript
- Styling: Tailwind CSS
- Testing: vitest

エージェントは、この技術スタックが持つ前提・制約を必ず尊重してください。

---

## Core Principles（基本方針）

### 1. 慣習より意図を優先する

「一般的だから」「よくあるから」という理由だけで、  
新しいレイヤ・ディレクトリ・抽象化・ライブラリを導入してはいけません。

何かを追加する前に、必ず次の問いに答えられる必要があります。

> このプロジェクトにおいて、どの具体的な問題を解決するのか？

答えが曖昧な場合、その変更は行わないでください。

---

### 2. Nuxt 4 の扱い方

- auto-import は意図を理解したうえで使用する
- 単純な関数で足りる場合、安易に composable を作らない
- トレードオフが不明瞭な場合は明示性を優先する

禁止事項：

- Nuxt 3 時代の回避策や慣習を検証なしに持ち込むこと
- Nuxt 4 での挙動を確認せず、動作を仮定すること

---

### 3. TypeScript の規律

- `any` の使用は禁止（明確な理由をコメントで示した場合のみ例外）
- 以下を優先すること：
  - union type
  - 判別可能な union
  - 不要な変更を防ぐための `readonly`

型が複雑になる場合：

- なぜ複雑さが必要なのかをコメントで説明する
- 実行時保証があるなら、より単純な型を検討する

---

### 4. Tailwind CSS のルール

- utility-first を基本とする
- `@apply` や抽象化は早期に行わない

許可される例：

- 意図が明確であれば、ユーティリティクラスの重複
- 意味的なまとまりを示す小さなコンポーネント化

避けること：

- 要件がない段階でのデザインシステム化
- ユーザーに見えない部分への過剰なスタイリング

---

### 5. テスト方針（vitest）

- テストは必ず決定論的であること
- 原則として unit test を優先する
- 境界を跨ぐ振る舞いのみ integration test を検討する

指針：

- 1 テスト = 1 振る舞い
- 共有された可変状態を持たない
- 実装ではなく振る舞いを名前にする

例：

```ts
descrive('APIクライアント', () => {
  it('トークンが期限切れの場合は null を返す', () => {
    // ...
  });
});
```

---

## File / Directory ルール

- Nuxt の標準ディレクトリ構成を尊重する
- 「将来使うかもしれない」ディレクトリは作らない
- すべてのディレクトリは存在理由を説明できる必要がある

迷った場合は、勝手に構造変更せず提案として相談してください。

---

## エージェントの意思決定ルール

コードを追加・変更する際は、以下を明示的に意識してください。

1. 対応している制約（技術・業務・運用）
2. トレードオフ
3. 最も単純な選択肢
4. 判断の痕跡（コメント or commit message）

エージェントは **黙って最適化してはいけません**。

---

## エージェントがしてはいけないこと

- 議論なしにライブラリを追加する
- 動いているコードを好みだけで書き換える
- 根拠のない最適化
- 他プロジェクトのパターンを無批判に適用する

---

## 判断に迷った場合

- 作業を止める
- 前提確認の質問をする
- 推測で進めない

誤った前提で進むより、止まる方が望ましい。

---

## Final Note（補足）

このリポジトリが重視するのは、

- 少ない概念
- 明確な意図
- 明示された判断

エージェントの役割は、
**人間の判断を置き換えることではなく、支えること**です。
